(()=>{"use strict";const e=JSON.parse(localStorage.getItem("tasks"));let t;function n(){if(document.querySelector(".todo-container").innerHTML="",!document.querySelector(".active"))return document.getElementById("Inbox").classList.add("active");let e=document.querySelector(".active").querySelector("a").textContent;d(),S.forEach((t=>{if(t.name===e)return function(e){document.querySelector(".todo-container").innerHTML="",document.getElementById("task-name").value="",document.getElementById("description").value="",document.getElementById("due-date").value="",document.getElementById("edit-name").value="",document.getElementById("edit-description").value="",document.getElementById("edit-due-date").value="";let t=e.tasks;const n=document.querySelector(".todo-container");t.forEach((e=>{const t=document.createElement("div");t.classList.add("todo"),t.innerHTML=`<input type="checkbox" id="${e.id}"  />\n        <label for="${e.id}" class="todo-label">\n          <div class="todo-title">${e.name}</div>\n          <div class="todo-due-date">${e.date}</div>\n        </label>\n        <div class="todo-icons">\n          <button class="see-more-btn">SEE MORE</button>\n          <img src="icons/pen-to-square-solid.svg" class="edit-btn" />\n          <img src="icons/trash-can-solid.svg" class="delete-btn" />\n        </div>\n      </div>`,function(e,t){if("Important"===e.priority)return t.style.background="linear-gradient(to right, red 8px, white 0)";"Normal"===e.priority&&(t.style.background="linear-gradient(to right, var(--blue) 8px, white 0)")}(e,t),function(e,t){l(e,t.querySelector("input"))}(e,t),n.append(t),document.querySelectorAll(".todo").forEach((e=>e.addEventListener("click",G)))}))}(t)}))}t=Array.isArray(e)?e:[];const o=document.querySelector(".submit-todo");function c(){if(!document.querySelector(".active"))return alert("Click on a project");!function(e,n,o,c,d){if(e.split(" ").length===e.length+1||""===e)return;o=i(o),(0===n.length||""===desciption)&&(n="No Description");let s=function(e,t="No Description",n,o,c,r=!1){return{name:e,description:t,date:n,priority:o,id:c,checked:r}}(e,n,o,c,d);t.push(s),a(),r(s)}(document.getElementById("task-name").value,document.getElementById("description").value,document.getElementById("due-date").value,document.getElementById("priority").value,(new Date).toTimeString())}function r(e){d(e),n(),s()}function i(e){if(""===e)return"No Date";const t=JSON.stringify(e);return`${t.slice(9,11)}/${t.slice(6,8)}/${t.slice(1,5)}`}function d(e){S.forEach((e=>{"Inbox"==e.name&&(e.tasks=t)})),function(e){let n=document.querySelector(".active"),o=n.querySelector("a").textContent;n.classList.contains("project")&&(S.filter((e=>"Inbox"!==e.name&&"Today"!==e.name&&"This Week"!==e.name&&"Important"!==e.name)).forEach((e=>{e.tasks.forEach(((n,o)=>{if(!t.includes(n))return e.tasks.splice(o,1)}))})),T(),e&&S.forEach((t=>{t.name===o&&(t.addTasks(e),T())})))}(e),S.forEach((e=>{"Important"==e.name&&(e.tasks.splice(0,e.tasks.length),t.forEach((t=>{if("Important"===t.priority)return e.addTasks(t)})))})),S.forEach((e=>{if("Today"===e.name||"This Week"===e.name){const n=new Date,o=n.getDate(),c=o<10?"0"+o:""+o,r=n.getMonth()+1,i=`${c}/${r<10?"0"+r:""+r}/${n.getFullYear()}`;!function(e,n){"Today"==e.name&&(e.tasks.splice(0,e.tasks.length),t.forEach((t=>{if(t.date===n)return e.addTasks(t)})))}(e,i),function(e,n){if("This Week"!=e.name)return;const o=new Date(Date.now()+6048e5);e.tasks.splice(0,e.tasks.length),t.forEach((t=>{const[c,r,i]=t.date.split("/"),d=new Date(+i,+r-1,+c),[s,a,u]=n.split("/");if(d>=new Date(+u,+a-1,+s)&&d<=o)return e.addTasks(t)}))}(e,i)}}))}const s=()=>{if(!J)return;const e=document.querySelector(".todo-form"),t=document.querySelector(".edit-todo-form");J=!1,(t.style.top="50%")&&(t.style.top="-100%"),(e.style.top="50%")&&(e.style.top="-100%")};function a(){localStorage.setItem("tasks",JSON.stringify(t))}function u(e){const n=e.target,o=n.id;let c;c=!0===n.checked,t.forEach((e=>{e.id===o&&(e.checked=c,console.log(t),l(e,n),a())}))}function l(e,t){const n=t.closest(".todo").querySelector(".todo-title");if(e.checked&&(n.classList.add("task-checked"),t.checked=!0),!e.checked&&(t.checked=!1,n.classList.contains("task-checked")))return n.classList.remove("task-checked")}const m=[];const p=document.querySelector(".submit-project");let y=[];const f=document.getElementById("inbox"),g=document.getElementById("today"),v=document.getElementById("this-week"),h=document.getElementById("important");y.push(f,g,v,h);let E,S=[];y.map((e=>{let t=function(e,t=[]){return{name:e,tasks:t,addTasks:e=>{t.push(e)}}}(e.querySelector("a").textContent);return S.push(t),{newProject:t}})),window.addEventListener("load",b);const k=JSON.parse(localStorage.getItem("new-projects"));function q(){!function(e){if(e.split(" ").length===e.length+1||""===e)return;let t=function(e,t,n=[]){return{name:e,id:t,tasks:n,addTasks:e=>{n.push(e)}}}(e,(new Date).toTimeString());E.push(t),S.push(t),T(),b()}(document.querySelector("#project-name").value)}E=Array.isArray(k)?k.map((e=>{let t=e.name,n=e.tasks,o=function(e,t,n=[]){return{name:e,id:t,tasks:n,addTasks:e=>{n.push(e)}}}(t,e.id,n);return S.push(o),o})):[];const L=document.querySelector(".projects");function b(){I(),E.forEach((e=>{const t=document.createElement("li");t.classList.add("project","tab"),t.innerHTML=`<a>${e.name}</a><img src="icons/kebab-menu.svg" class="kebab-menu"/>\n    <div class="projects-btn" id="${e.id}">\n      <div class="delete-project">Delete</div>\n      <div class="edit-project">Edit</div>\n    </div>`,t.addEventListener("click",z),t.addEventListener("click",w),L.append(t)})),j(),n()}const I=()=>{L.innerHTML="",document.querySelector("#project-name").value="",document.querySelector("#edit-project-name").value=""},j=()=>{const e=document.querySelector(".project-form"),t=document.querySelector(".edit-project-form");J=!1,"50%"===e.style.top&&(e.style.top="-100%"),"50%"===t.style.top&&(t.style.top="-100%")};function T(){localStorage.setItem("new-projects",JSON.stringify(E))}function w(e){return e.target.classList.contains("kebab-menu")?function(e){if(e.target.classList.contains("kebab-menu"))return e.target.closest(".project").querySelector(".projects-btn").classList.add("show-menu"),void setTimeout(B,100)}(e):e.target.classList.contains("delete-project")?function(e){const t=e.target.closest(".projects-btn").getAttribute("id");E=E.filter((e=>e.id!==t&&(e.id!=t||void 0))),T(),b()}(e):e.target.classList.contains("edit-project")?function(e){const t=e.target.closest(".projects-btn").getAttribute("id");J||(document.querySelector(".edit-project-form").style.top="50%",E.forEach((e=>{if(e.id==t)return e.id===t?function(e){document.querySelector("#edit-project-name").value=e.name;const t=document.querySelector("#edit-project-name").value;t.split(" ").length!==t.length+1&&""!==t&&document.querySelector(".submit-edit-project").addEventListener("click",(()=>{e.name=document.querySelector("#edit-project-name").value,T(),b()}),{once:!0})}(e):void 0})))}(e):void 0}function B(){0!==document.querySelectorAll(".show-menu").length&&window.addEventListener("click",(()=>{document.querySelectorAll(".show-menu").forEach((e=>e.classList.remove("show-menu")))}),{once:!0})}const N=document.querySelector(".addTodoBtn"),D=document.querySelector(".add-project"),$=document.querySelectorAll(".see-more-btn"),x=document.querySelector(".todo-form"),A=document.querySelector(".project-form"),C=document.querySelector(".see-more"),M=document.querySelector(".edit-todo-form"),O=document.querySelector(".edit-project-form"),H=document.querySelector(".search-bar");let J=!1;function W(e){if(!J)return J=!0,document.addEventListener("keypress",P),N===e.currentTarget?x.style.top="50%":D===e.currentTarget?A.style.top="50%":void 0}const F=document.querySelectorAll(".close-btn");function Y(e){return J=!1,x===e.currentTarget.parentNode.parentNode?x.style.top="-100%":A===e.currentTarget.parentNode.parentNode?A.style.top="-100%":C===e.currentTarget.parentNode.parentNode?C.style.top="-100%":M===e.currentTarget.parentNode.parentNode?M.style.top="-100%":O===e.currentTarget.parentNode.parentNode?O.style.top="-100%":void 0}function P(e){return"50%"===A.style.top&&"Enter"===e.key?q():"50%"===x.style.top&&"Enter"===e.key?c():void 0}function R(e){J||(J=!0,function(e){const n=e.querySelector("input").id;t.forEach((e=>{n==e.id&&(document.querySelector(".see-more-todo-title").textContent=`${e.name}`,document.querySelector(".see-more-todo-due-date").textContent=`${e.date}`,document.querySelector(".see-more-todo-description").textContent=`${e.description}`,document.querySelector(".see-more-todo-priority").textContent=`${e.priority}`)}))}(e),C.style.top="50%")}function z(e){0!=document.querySelectorAll(".active").length&&document.getElementsByClassName("active")[0].classList.remove("active"),e.currentTarget.classList.add("active"),n()}function G(e){const n=e.target,o=n.closest(".todo");return n.classList.contains("see-more-btn")?R(o):n.classList.contains("delete-btn")?function(e){const n=e.querySelector("input").id;t=t.filter((e=>n!==e.id&&(n!=e.id||void 0))),a(),r()}(o):n.classList.contains("edit-btn")?function(e){if(J)return;document.querySelector(".edit-todo-form").style.top="50%",J=!0;const n=e.querySelector("input").id;t.forEach((e=>{if(n===e.id)return function(e){document.getElementById("edit-name").value=e.name,document.getElementById("edit-description").value=e.description,document.getElementById("edit-priority").value=e.priority;const t=function(e){if(""===e)return"No Date";const[t,n,o]=e.split("/"),c=new Date(+o,n,+t);return[c.getFullYear(),c.getMonth()<10?`0${c.getMonth()}`:c.getMonth(),c.getDate()<10?`0${c.getDate()}`:c.getDate()].join("-")}(e.date);document.getElementById("edit-due-date").value=t,document.querySelector(".edit-todo").addEventListener("click",(()=>{!function(e){if(e.name.split(" ").length===e.name.length+1||""===e.name)return;e.name=document.getElementById("edit-name").value;const t=document.getElementById("edit-due-date").value;e.date=i(t),e.priority=document.getElementById("edit-priority").value,""===document.getElementById("edit-description").value?e.description="No Description":e.description=document.getElementById("edit-description").value,a(),r()}(e)}),{once:!0})}(e)}))}(o):void o.querySelector("input").addEventListener("change",u)}document.querySelectorAll(".tab").forEach((e=>e.addEventListener("click",z))),window.addEventListener("load",n),N.addEventListener("click",W),D.addEventListener("click",W),F.forEach((e=>e.addEventListener("click",Y))),$.forEach((e=>e.addEventListener("click",R))),o.addEventListener("click",c),p.addEventListener("click",q),H.addEventListener("input",(function(e){const n=e.target.value.toLowerCase();m.splice(0,m.length);let o=document.querySelector(".active").querySelector("a").textContent;S.forEach((e=>{if(e.name===o)return function(e,n){e.tasks.forEach((e=>{e.name.toLowerCase().includes(n)&&(m.push(e),function(e){const n=document.querySelectorAll(".todo");n.forEach((e=>{const n=e.querySelector("input").id;t.forEach((t=>{if(t.id==n)return m.includes(t)?m.includes(t)?e.style.display="grid":void 0:e.style.display="none"}))})),""===e&&n.forEach((e=>{e.style.display="grid"}))}(n))}))}(e,n)}))}))})();